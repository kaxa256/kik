<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Futuristic Calculator</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap');

  :root {
    --bg-color: #f0f3f7;
    --text-color: #222;
    --screen-bg: rgba(255 255 255 / 0.7);
    --screen-text: #111;
    --button-bg: #222;
    --button-text: #eee;
    --button-glow: #0ff;
    --button-shadow: rgba(0 255 255 / 0.3);
    --accent-color: #0ff;
    --transition-fast: 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Reset and base styling */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin:0; padding:0;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'Orbitron', sans-serif;
    background: linear-gradient(135deg, #d0e8f2, #f0f3f7);
    color: var(--text-color);
    user-select: none;
  }

  .calculator {
    background: linear-gradient(145deg, #c0d7e4, #e6f0f8);
    border-radius: 1.5rem;
    box-shadow:
      inset 5px 5px 10px #a1b2c6,
      inset -5px -5px 12px #ffffff,
      8px 8px 20px rgba(0, 128, 255, 0.15);
    width: 320px;
    max-width: 90vw;
    padding: 1.6rem 1.8rem 2rem;
    perspective: 1000px;
    transition: transform 0.4s cubic-bezier(0.4,0,0.2,1);
  }

  .calculator.active {
    transform: rotateX(4deg) rotateY(6deg);
  }

  .screen {
    background: var(--screen-bg);
    border-radius: 1rem;
    padding: 1.4rem 1.6rem;
    font-size: 2.6rem;
    color: var(--screen-text);
    min-height: 4.2rem;
    text-align: right;
    line-height: 1.2;
    box-shadow:
      inset 10px 10px 20px #d9e5f2,
      inset -10px -10px 20px #ffffff;
    user-select: text;
    letter-spacing: 0.04em;
    font-variant-numeric: tabular-nums;
  }

  .buttons {
    margin-top: 1.6rem;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem 1rem;
  }

  button {
    position: relative;
    background: var(--button-bg);
    border: none;
    border-radius: 0.8rem;
    box-shadow:
      0 8px 15px rgba(0, 128, 255, 0.25),
      inset 0 -4px 4px rgba(255 255 255 / 0.2);
    color: var(--button-text);
    font-size: 1.4rem;
    font-weight: 600;
    cursor: pointer;
    outline-offset: 3px;
    outline-color: transparent;
    user-select: none;
    transition:
      background-color 0.3s ease,
      box-shadow 0.3s ease,
      transform 0.1s ease;
    overflow: hidden;
  }

  button:focus-visible {
    outline-color: var(--accent-color);
  }

  /* 3D press effect */
  button:active {
    transform: translateZ(-4px) scale(0.95);
    box-shadow:
      inset 0 3px 5px rgba(0, 0, 0, 0.5),
      0 2px 6px rgba(0, 0, 0, 0.2);
  }

  /* Glow effect on active */
  button.glow {
    animation: glowPulse 0.4s ease forwards;
  }

  @keyframes glowPulse {
    0% { box-shadow: 0 0 0 0 rgba(0, 255, 255, 0.7); }
    50% { box-shadow: 0 0 12px 8px rgba(0, 255, 255, 0.8); }
    100% { box-shadow: 0 0 0 0 rgba(0, 255, 255, 0); }
  }

  /* Ripple wave effect */
  .ripple {
    position: absolute;
    border-radius: 50%;
    transform: scale(0);
    animation: rippleEffect 0.6s linear;
    background-color: rgba(255, 255, 255, 0.6);
    pointer-events: none;
    z-index: 10;
  }

  @keyframes rippleEffect {
    to {
      transform: scale(4);
      opacity: 0;
    }
  }

  /* Specific button styling for operators and clear */
  button.operator {
    color: #0ff;
    font-weight: 700;
    background: #111;
    box-shadow:
      0 8px 20px #00ffffaa,
      inset 0 -4px 6px #0ff9;
  }
  button.operator:active {
    box-shadow:
      inset 0 3px 8px rgba(0, 255, 255, 0.9),
      0 2px 10px rgba(0, 255, 255, 0.8);
  }

  button.clear {
    background: #ff0044;
    color: #fff;
    font-weight: 700;
    box-shadow:
      0 8px 20px #ff3366aa,
      inset 0 -4px 6px #ff5588cc;
  }
  button.clear:active {
    box-shadow:
      inset 0 3px 8px rgba(255, 0, 68, 0.9),
      0 2px 10px rgba(255, 0, 68, 0.8);
  }

  /* Responsive adjustments */
  @media (max-width: 400px) {
    .calculator {
      width: 100vw;
      height: 100vh;
      border-radius: 0;
      padding: 2rem 1.2rem;
      box-shadow: none;
      background: linear-gradient(135deg, #d0e8f2, #f0f3f7);
    }

    .screen {
      font-size: 2rem;
      min-height: 3.8rem;
      padding: 1rem 1.2rem;
    }

    button {
      font-size: 1.2rem;
      padding: 1rem 0;
      border-radius: 0.6rem;
    }
  }
</style>
</head>
<body>
  <main class="calculator" role="application" aria-label="Futuristic Calculator">
    <div class="screen" id="screen" role="textbox" aria-live="polite" aria-atomic="true" tabindex="0">0</div>
    <div class="buttons" role="group" aria-label="Calculator buttons">
      <button type="button" class="clear" data-value="clear" aria-label="Clear">C</button>
      <button type="button" class="operator" data-value="/" aria-label="Divide">÷</button>
      <button type="button" class="operator" data-value="*" aria-label="Multiply">×</button>
      <button type="button" class="operator" data-value="-" aria-label="Subtract">−</button>

      <button type="button" data-value="7" aria-label="Number 7">7</button>
      <button type="button" data-value="8" aria-label="Number 8">8</button>
      <button type="button" data-value="9" aria-label="Number 9">9</button>
      <button type="button" class="operator" data-value="+" aria-label="Add">+</button>

      <button type="button" data-value="4" aria-label="Number 4">4</button>
      <button type="button" data-value="5" aria-label="Number 5">5</button>
      <button type="button" data-value="6" aria-label="Number 6">6</button>
      <button type="button" data-value="=" aria-label="Equal">=</button>

      <button type="button" data-value="1" aria-label="Number 1">1</button>
      <button type="button" data-value="2" aria-label="Number 2">2</button>
      <button type="button" data-value="3" aria-label="Number 3">3</button>
      <button type="button" data-value="." aria-label="Decimal point">.</button>

      <button type="button" data-value="0" aria-label="Number 0" style="grid-column: span 2;">0</button>
    </div>
  </main>
<script>
  (() => {
    const screen = document.getElementById('screen');
    const buttons = document.querySelectorAll('.buttons button');
    let currentInput = '';
    let lastResult = null;

    // Web Audio API click sound
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    const audioCtx = new AudioContext();

    function playClickSound() {
      if (audioCtx.state === 'suspended') {
        audioCtx.resume();
      }
      const oscillator = audioCtx.createOscillator();
      const gainNode = audioCtx.createGain();
      oscillator.type = 'square';
      oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
      gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.1);
      oscillator.connect(gainNode);
      gainNode.connect(audioCtx.destination);
      oscillator.start(audioCtx.currentTime);
      oscillator.stop(audioCtx.currentTime + 0.1);
    }

    function getRandomColor() {
      // Generate neon pastel colors
      const hue = Math.floor(Math.random() * 360);
      return `hsl(${hue}, 100%, 70%)`;
    }

    function createRipple(event) {
      const button = event.currentTarget;
      const circle = document.createElement('span');
      const diameter = Math.max(button.clientWidth, button.clientHeight);
      const rect = button.getBoundingClientRect();
      circle.style.width = circle.style.height = diameter + 'px';
      circle.style.left = (event.clientX - rect.left - diameter / 2) + 'px';
      circle.style.top = (event.clientY - rect.top - diameter / 2) + 'px';
      circle.classList.add('ripple');
      button.appendChild(circle);
      circle.addEventListener('animationend', () => circle.remove());
    }

    function updateScreen(value) {
      screen.textContent = value;
    }

    function calculateExpression(expression) {
      try {
        // Sanitize expression before eval
        if(/[^0-9+\-*/.() ]/.test(expression)) return 'Error';
        let result = Function('"use strict";return (' + expression + ')')();
        if (typeof result === 'number' && !isNaN(result) && isFinite(result)) {
          return result;
        }
        return 'Error';
      } catch {
        return 'Error';
      }
    }

    function handleInput(value) {
      if (value === 'clear') {
        currentInput = '';
        lastResult = null;
        updateScreen('0');
        return;
      }
      if (value === '=') {
        if (currentInput.trim() === '') return;
        const result = calculateExpression(currentInput);
        updateScreen(result);
        lastResult = result;
        currentInput = result === 'Error' ? '' : result.toString();
        return;
      }
      // Append value - restrict multiple operators
      const operators = ['+', '-', '*', '/'];
      const lastChar = currentInput.slice(-1);
      if (operators.includes(value)) {
        if (currentInput === '' && value !== '-') return; // no leading operator except minus
        if (operators.includes(lastChar)) {
          // replace last operator with current operator
          currentInput = currentInput.slice(0, -1) + value;
          updateScreen(currentInput);
          return;
        }
      }
      // Manage decimal multiple
      if (value === '.') {
        // prevent multiple decimals in a number chunk
        const parts = currentInput.split(/[\+\-\*\/]/);
        const lastPart = parts[parts.length - 1];
        if (lastPart.includes('.')) return;
      }
      if (lastResult !== null && !operators.includes(value)) {
        // If last result shown and user enters number or dot, reset input
        if (currentInput === lastResult.toString()) {
          currentInput = '';
          lastResult = null;
        }
      }
      currentInput += value;
      updateScreen(currentInput);
    }

    function buttonPress(event) {
      const button = event.currentTarget;

      // Random background color
      const randomColor = getRandomColor();
      button.style.backgroundColor = randomColor;
      // Change text color dynamically for contrast
      // Simple luminance check for black/white text
      const rgb = getComputedStyle(button).backgroundColor.match(/\d+/g).map(Number);
      const luminance = (0.299*rgb[0]+0.587*rgb[1]+0.114*rgb[2]) / 255;
      button.style.color = luminance > 0.6 ? '#111' : '#eee';

      // Add glow effect class
      button.classList.add('glow');
      setTimeout(() => button.classList.remove('glow'), 400);

      // Ripple effect
      createRipple(event);

      // Play click sound
      playClickSound();

      // 3D tilt effect on calculator
      const calculator = document.querySelector('.calculator');
      calculator.classList.add('active');
      clearTimeout(calculator._tiltTimeout);
      calculator._tiltTimeout = setTimeout(() => {
        calculator.classList.remove('active');
      }, 300);

      // Handle calculator logic
      const value = button.dataset.value;
      handleInput(value);
    }

    buttons.forEach(btn => btn.addEventListener('click', buttonPress));

    // Keyboard support for accessibility
    window.addEventListener('keydown', (event) => {
      if(event.repeat) return;
      const keyMap = {
        '0': '0', '1': '1', '2':'2', '3':'3', '4':'4', '5':'5', '6':'6', '7':'7', '8':'8', '9':'9',
        '+': '+', '-': '-', '*': '*', '/': '/', 'Enter': '=', '=': '=', 'Backspace': 'clear',
        'Delete': 'clear', '.': '.',
      };
      const val = keyMap[event.key];
      if(!val) return;
      // Find the button with that data-value
      const btn = Array.from(buttons).find(button => button.dataset.value === val);
      if(btn) {
        btn.focus();
        btn.click();
        event.preventDefault();
      }
    });
  })();
</script>
</body>
</html>

